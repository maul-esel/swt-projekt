language: csharp
solution: Lingvo/Solution/Lingvo.sln

dist: trusty
sudo: required

matrix:
  include:
    - os: linux
      mono: none
      dotnet: 1.0.0-preview3-004056
      env: DOTNETCORE=1
    - os: osx
      osx_image: xcode8.1
      mono: latest
      dotnet: none
      env:
        - XAMARIN=1
        - ANDROID_HOME=/usr/local/opt/android-sdk

install:
  - ./scripts/install-xamarin.sh

script:
  - ./scripts/build-backend.sh
  - ./scripts/build-xamarin.sh

env:
  global:
    # AZURE_WA_USERNAME:
    - secure: c/gWD6pN7CVD15ApDpQfk8VnIn11vhmW8X3FcVssLTXTPlArEmBHtNJOpXICBKq/LLplgdQlZt8ZS/NmRLVfpewhZ1XoAloYQhdHXHejf2t7Urem5uHJfDYoxwz9rfTI9EJLqk3QdfRtmMFBHApt9dUlBRvF5B+eQE+44su/mA+VvmJiKBfiPzdtKnOE1XBx2rHbafb2gOF7KAO9X110KgWjLNr7PjJTexEAAIYtg4VyQQ1aS2ehafAUDQaPPjKNOzJPGVX/EuQX7JXrJ6JLnTqDdKhNZv8meFxro9nWqyrQGkmAjI4ndn8ILCoYspEPpnx6XOEXxm/w31ZAOMfRd0rvM0sEo0i8nbh/YFK7JFVeAE2P1slvSKmcX9Hw8r1qjmPUxuqkXooRAGNYG1GEYVuLJ6oabA37YWGebslteTIKe5qIqp/Wi+u5yxe2UgY9T2rT3C8U15aBGckhItecgSI8N8ieI7drTt1rD7MxPUAP9lXg4rsqpSRhCRL3PuoiJn41k0amLFtEhyH6tMG+if4WeGe7JzNGGsTJJyC4w9TDS5OuMQJxUjBn+IT/VvcwkkQIsJjHL9DLZIJwLIf+4lmzebwP1lHjoOrnNENxLF/gGaUiaqTK7IvKo2UtGhU+fnQEOm5MPdd/lNtX1j0pC8ZmvUTDfVQwt+P7P3iXppc=
    # AZURE_WA_PASSWORD:
    - secure: SlyoZRSmW3W9Lr1O/uvOVWe+ZqW28n91FiSapOfgE8nFBD8wLksadrtUJomBlhmrqPp6cXQM+GB6mG8fR6NGb1cH1Z9KE1nFF/Zi1YFXYAynHFssYVLl+RSP/3BSYTdsYjR3g0sDUPTickvr9lGUoOX2SaKYSTvGthE87A56pj2fVkkXfPbEBOeIVXKmWvtG5bBNXL6gVanQdIXe0751MOhA/XI6ZtRRNYsCfwerkbk/FRcK1qiq2v5shfXT2R2wBKld+u7ulNFawlnaX21mNNdokiThifYK6pQ6Bb8Soa9FW4TO/GHAstDLDKEbKP4iAKIvVdQ3xYAww8OjJ4vDQmYGj84sJbXMf0D+9lnZS8fxo4MJQWrxnTHYQG1oxrXTdjuMczsufcLt/Yw0CuBZDr5stuXrboRlzxU9Dntv46oNiP/Ze/+u9dlapeK06OXBKCo4rO50YT1HHcgSSnt9I5edaqa2mpzyM9j+nH+dM4otnMv4QHSR/eqhZj4fD5NTSwBZTRONWKsQNVvqPvrFdlMSxgWVvpgteXKvIH2r08uJfrK6mM15FVY31Aif9KSK7KMVQ4gqIzG9lykbjveiQzT1kibCzosEND/SFsH04moGq2CT569ptevOQrzhJgphokEVhvMwzqLwxLSiJBjUniWB/e78I37XzXcfrqzul1Q=

before_deploy: git fetch --unshallow

deploy:
  provider: azure_web_apps
  site: lingvo
  verbose: true
  on:
    branch: solution-setup
    # TODO: deploy on master !
    condition: $DOTNETCORE = 1
